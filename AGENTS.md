# Guidelines for AI contributors

This repo hosts a small Go web service that generates lotto numbers. The project
follows the standard Go project layout and is built around a few internal
packages. The structure is lightweight but knowing where functionality lives and
how it is built is important for productivity.

## Architecture
- `cmd/lotto-numbers/main.go` is the entry point. It configures tracing,
  middleware and HTTP routes using **gorilla/mux**.
- HTTP routes are defined in `internal/handlers/routes.go` and implemented in
  `internal/handlers/handlers.go`. Routes served:
  - `GET /` — serves `index.html` from the embedded `web/` filesystem
  - `GET /assets/*` — serves static assets from the embedded `web/assets/`
    filesystem
  - `GET /numbers` — generates lottery numbers (JSON)
  - `GET /version` — returns the build version string
- Lottery numbers are generated by `internal/generator`. The generator returns a
  slice of unique number lines which is wrapped in the `models.LotteryNumbers`
  struct defined in `internal/models`.
- Middleware such as logging lives under `internal/middleware`.
- OpenTelemetry/Uptrace setup resides in `internal/tracing` and requires the
  environment variable `UPTRACE_DSN` (see `.env.example`).
- Application version is injected at build time and read from
  `internal/version`.

## Development workflow
- Run tests with `go test ./...` as done in CI. Linting uses golangci-lint
  (see `.devcontainer` and GitHub workflows).
- Build locally via `go build ./...` or run the server with
  `go run ./cmd/lotto-numbers`. The server listens on `PORT` (default 8091).
- Container builds use `deploy/dockerfile`; `docker compose -f deploy/compose.yml up`
  starts the service locally using `.env` variables.
- Versioning is handled by GitVersion (`GitVersion.yml`); commit messages must
  follow **Conventional Commits** so release versions are computed correctly.
- GoReleaser (`.goreleaser.yml`) produces cross-platform binaries for Linux,
  Windows and macOS.
- CI also runs a **CodeQL** analysis workflow (`.github/workflows/codeql.yml`).

## Patterns and conventions
- All source files should be formatted with `gofmt` and respect `.editorconfig`.
- Static web assets (`index.html`, JS and CSS) are embedded—no separate
  filesystem path is required at runtime.
- Tests use `stretchr/testify` assertions. Coverage and vet outputs are consumed
  by CI and SonarCloud (`sonar-project.properties`).
- New handlers should be wired through `SetupRoutes` and covered by tests similar
  to those in `internal/handlers/*_test.go`.
